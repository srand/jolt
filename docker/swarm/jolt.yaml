version: "3.5"
services:
  cache:
    image: nginx:latest
    deploy:
      replicas: 1
    configs:
      - source: nginx.conf
        target: /etc/nginx/nginx.conf
    ports:
      - "8080:80"
    volumes:
      - cache-http:/usr/share/nginx/html
  dashboard:
    image: robrt/jolt-dashboard:latest
    ports:
      - "80:80"
  scheduler:
    image: robrt/jolt/scheduler:latest
    ports:
      - "9090:9090"
  worker:
    image: robrt/jolt/worker:latest
    deploy:
      replicas: 2
    configs:
      - source: worker.conf
        target: /root/.config/jolt/config
    volumes:
      - cache-node:/root/.cache/jolt
configs:
  worker.conf:
    file: ./worker.conf
  nginx.conf:
    file: ./nginx.conf
volumes:
  cache-node:
  cache-http:
